<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Mando MAES</title>
    <meta name="apple-mobile-web-app-title" content="Mando MAES">
    <meta name="application-name" content="Mando MAES">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#020617">

    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIzcHgiIGhlaWdodD0iMjIzcHgiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbD0ibm9uZSI+PHJlY3Qgd2lkdGg9IjEwMjQiIGhlaWdodD0iMTAyNCIgZmlsbD0iI2ZmZmZmZiIvPjxnIHRyYW5zZm9ybT0icm90YXRlKDQ1IDUxMiA1MTIpIj48cGF0aCBkPSJNNjg3LjUgMTU0LjZjLTEwMi4yLTgyLjgtMjQ5LjEtODIuOC0zNTEuMiAwIDAgMC0xOS45IDIxLjctMzMuOSAyMS43cy03LjgtMjEuNy03LjgtMjEuN2MxMjAtMTIwIDMxNC42LTEyMCA0MzQuNiAwIDAgMCA2LjIgMjEuNy03LjggMjEuN3MtMzMuOS0yMS43LTMzLjktMjEuN3oiIGZpbGw9IiMwMDAwMDAiLz48cGF0aCBkPSJNMzU4LjIgMjMyLjJjLTE0IDAtNC40LTE4LjQtNC40LTE4LjQtemLjMtODcuMyAyMjguOC04Ny4zIDMxNi4xIDAgMCAwIDkuNiAxOC40LTQuNCAxOC40cy0zOC40LTE4LjQtMzguNC0xOC40Yy02OC40LTUwLTE2Mi01MC0yMzAuNSAwIDAgMC0yNC40IDE4LjQtMzguNCAxOC40eiIgZmlsbD0iIzAwMDAwMCIvPjxwYXRoIGQ9Ik00MTMuMSAyODguMWMtMTUgMCAwLTE1IDAtMTUgNTQuNi01NC42IDE0My01NC42IDE5Ny42IDAgMCAwIDE1IDE1IDAgMTVzLTQ2LjQtMTUtNDYuNC0xNWMtMzIuNi0xNy4zLTcyLTE3LjMtMTA0LjcgMCAwIDAtMzEuNSAxNS00Ni41IDE1ek0yNjAuNCA0ODMuNmMwLTMwLjkgMjMuNC02NC45IDUyLjQtNzQuOCAwIDAgODEtMzcgMjAyLjktMzdTNzExLjIgNDA4IDcxMS4yIDQwOGMyOC44IDEwLjkgNTIuMSA0NC42IDUyLjEgNzUuNnYzNjMuMmMwIDMwLjktMjMuMiA2NS4yLTUyLjEgNzUuNiAwIDAtNzMuNiAzNi4yLTE5NS41IDM2LjJzLTIwMi45LTM3LTIwMi45LTM3Yy0yOS0xMC40LTUyLjQtNDMuOC01Mi40LTc0LjhWNDgzLjZ6IiBmaWxsPSIjMDAwMDAwIi8+PHBhdGggZD0iTTMxNi4zIDQ4My42djM2My4yYzAgNy40IDguNyAxOS44IDE1LjUgMjIuMmw0LjIgMS43YzEuMiAwLjYgNC44IDIgMTAuNSA0LjEgMTAuMiAzLjcgMjIuMyA3LjUgMzYuMSAxMS4xIDM5LjkgMTAuNCA4NC43IDE2LjcgMTMzIDE2LjcgNDguMiAwIDkxLjUtNi4xIDEyOC45LTE2LjIgMjEuNi01LjggMzUuOC0xMS4zIDQxLjktMTQuM2wyLjktMS40IDMtMS4xYzYuMi0yLjIgMTUuMS0xNS4yIDE1LjEtMjN2LTM2M2MwLTcuNy04LjktMjAuNi0xNi0yMy4zbC00LjktMi4xYy02LjEtMy0yMC4zLTguNS00MS45LTE0LjMtMzcuNS0xMC4xLTgwLjctMTYuMi0xMjguOS0xNi4yLTQ4LjMgMC05My4xIDYuMy0xMzMgMTYuNy0xMy44IDMuNi0yNS45IDcuNC0zNi4xIDExLjEtNS43IDIuMS05LjMgMy42LTEwLjUgNC4xbC01LjEgMmMtNiAyLjItMTQuNyAxNC42LTE0LjcgMjJ6IiBmaWxsPSIjRkZGRkZGIi8+PHBhdGggZD0iTTU5NS43IDYyMy4zYy0zMC45IDAtNTUuOS0yNS01NS45LTU1LjlzMjUtNTUuOSA1NS45LTU1LjkgNTUuOSAyNSA1NS45IDU1LjktMjUgNTUuOS01NS45IDU1Ljl6TTQyOC4xIDYyMy4zYy0zMC45IDAtNTUuOS0yNS01NS45LTU1LjlzMjUtNTUuOSA1NS45LTU1LjkgNTUuOSAyNSA1NS45IDU1LjljLTAuMSAzMC45LTI1LjEgNTUuOS01NS45IDU1Ljl6TTUxMS45IDg0Ni44Yy00Ni4zIDAtODMuOC0zNy41LTgzLjgtODMuOHMzNy41LTgzLjggODMuOC04My44IDgzLjggMzcuNSA4My44IDgzLjggMzcuNSA4My44LTgzLjggODMuOHoiIGZpbGw9IiMwMDAwMDAiLz48cGF0aCBkPSJNNTk1LjcgNTk1LjRjMTUuNCAwIDI3LjktMTIuNSAyNy45LTI3LjlzLTEyLjUtMjcuOS0yNy45LTI3LjktMjcuOSAxMi41LTI3LjkgMjcuOSAxMi41IDI3LjkgMjcuOSAyNy45ek00MjguMSA1OTUuNGMxNS40IDAgMjcuOS0xMi41IDI3LjktMjcuOXMtMTIuNS0yNy45LTI3LjktMjcuOWMtMTUuNCAwLTI3LjkgMTIuNS0yNy45IDI3LjktMC4xIDE1LjQgMTIuNCAyNy45IDI3LjkgMjcuOXpNNTExLjkgODE4LjljMzAuOSAwIDU1LjktMjUgNTUuOS01NS45cy0yNS01NS45LTU1LjktNTUuOS01NS45IDI1LTU1LjkgNTUuOSAyNSA1NS45IDU1LjkgNTUuOXoiIGZpbGw9IiNGRkZGRkYiLz48L2c+PC9zdmc+">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIzcHgiIGhlaWdodD0iMjIzcHgiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbD0ibm9uZSI+PHJlY3Qgd2lkdGg9IjEwMjQiIGhlaWdodD0iMTAyNCIgZmlsbD0iI2ZmZmZmZiIvPjxnIHRyYW5zZm9ybT0icm90YXRlKDQ1IDUxMiA1MTIpIj48cGF0aCBkPSJNNjg3LjUgMTU0LjZjLTEwMi4yLTgyLjgtMjQ5LjEtODIuOC0zNTEuMiAwIDAgMC0xOS45IDIxLjctMzMuOSAyMS43cy03LjgtMjEuNy03LjgtMjEuN2MxMjAtMTIwIDMxNC42LTEyMCA0MzQuNiAwIDAgMCA2LjIgMjEuNy03LjggMjEuN3MtMzMuOS0yMS43LTMzLjktMjEuN3oiIGZpbGw9IiMwMDAwMDAiLz48cGF0aCBkPSJNMzU4LjIgMjMyLjJjLTE0IDAtNC40LTE4LjQtNC40LTE4LjQtemLjMtODcuMyAyMjguOC04Ny4zIDMxNi4xIDAgMCAwIDkuNiAxOC40LTQuNCAxOC40cy0zOC40LTE4LjQtMzguNC0xOC40Yy02OC40LTUwLTE2Mi01MC0yMzAuNSAwIDAgMC0yNC40IDE4LjQtMzguNCAxOC40eiIgZmlsbD0iIzAwMDAwMCIvPjxwYXRoIGQ9Ik00MTMuMSAyODguMWMtMTUgMCAwLTE1IDAtMTUgNTQuNi01NC42IDE0My01NC42IDE5Ny42IDAgMCAwIDE1IDE1IDAgMTVzLTQ2LjQtMTUtNDYuNC0xNWMtMzIuNi0xNy4zLTcyLTE3LjMtMTA0LjcgMCAwIDAtMzEuNSAxNS00Ni41IDE1ek0yNjAuNCA0ODMuNmMwLTMwLjkgMjMuNC02NC45IDUyLjQtNzQuOCAwIDAgODEtMzcgMjAyLjktMzdTNzExLjIgNDA4IDcxMS4yIDQwOGMyOC44IDEwLjkgNTIuMSA0NC42IDUyLjEgNzUuNnYzNjMuMmMwIDMwLjktMjMuMiA2NS4yLTUyLjEgNzUuNiAwIDAtNzMuNiAzNi4yLTE5NS41IDM2LjJzLTIwMi45LTM3LTIwMi45LTM3Yy0yOS0xMC40LTUyLjQtNDMuOC01Mi40LTc0LjhWNDgzLjZ6IiBmaWxsPSIjMDAwMDAwIi8+PHBhdGggZD0iTTMxNi4zIDQ4My42djM2My4yYzAgNy40IDguNyAxOS44IDE1LjUgMjIuMmw0LjIgMS43YzEuMiAwLjYgNC44IDIgMTAuNSA0LjEgMTAuMiAzLjcgMjIuMyA3LjUgMzYuMSAxMS4xIDM5LjkgMTAuNCA4NC43IDE2LjcgMTMzIDE2LjcgNDguMiAwIDkxLjUtNi4xIDEyOC45LTE2LjIgMjEuNi01LjggMzUuOC0xMS4zIDQxLjktMTQuM2wyLjktMS40IDMtMS4xYzYuMi0yLjIgMTUuMS0xNS4yIDE1LjEtMjN2LTM2M2MwLTcuNy04LjktMjAuNi0xNi0yMy4zbC00LjktMi4xYy02LjEtMy0yMC4zLTguNS00MS45LTE0LjMtMzcuNS0xMC4xLTgwLjctMTYuMi0xMjguOS0xNi4yLTQ4LjMgMC05My4xIDYuMy0xMzMgMTYuNy0xMy44IDMuNi0yNS45IDcuNC0zNi4xIDExLjEtNS43IDIuMS05LjMgMy42LTEwLjUgNC4xbC01LjEgMmMtNiAyLjItMTQuNyAxNC42LTE0LjcgMjJ6IiBmaWxsPSIjRkZGRkZGIi8+PHBhdGggZD0iTTU5NS43IDYyMy4zYy0zMC45IDAtNTUuOS0yNS01NS45LTU1LjlzMjUtNTUuOSA1NS45LTU1LjkgNTUuOSAyNSA1NS45IDU1LjktMjUgNTUuOS01NS45IDU1Ljl6TTQyOC4xIDYyMy4zYy0zMC45IDAtNTUuOS0yNS01NS45LTU1LjlzMjUtNTUuOSA1NS45LTU1LjkgNTUuOSAyNSA1NS45IDU1LjljLTAuMSAzMC45LTI1LjEgNTUuOS01NS45IDU1Ljl6TTUxMS45IDg0Ni44Yy00Ni4zIDAtODMuOC0zNy41LTgzLjgtODMuOHMzNy41LTgzLjggODMuOC04My48IDgzLjggMzcuNSA4My44IDgzLjgtMzcuNSA4My44LTgzLjggODMuOHoiIGZpbGw9IiMwMDAwMDAiLz48cGF0aCBkPSJNNTk1LjcgNTk1LjRjMTUuNCAwIDI3LjktMTIuNSAyNy45LTI3LjlzLTEyLjUtMjcuOS0yNy45LTI3LjktMjcuOSAxMi41LTI3LjkgMjcuOSAxMi41IDI3LjkgMjcuOSAyNy45ek00MjguMSA1OTUuNGMxNS40IDAgMjcuOS0xMi41IDI3LjktMjcuOXMtMTIuNS0yNy45LTI3LjktMjcuOWMtMTUuNCAwLTI3LjkgMTIuNS0yNy45IDI3LjktMC4xIDE1LjQgMTIuNCAyNy45IDI3LjkgMjcuOXpNNTExLjkgODE4LjljMzAuOSAwIDU1LjktMjUgNTUuOS01NS45cy0yNS01NS45LTU1LjktNTUuOS01NS45IDI1LTU1LjkgNTUuOSAyNSA1NS45IDU1LjkgNTUuOXoiIGZpbGw9IiNGRkZGRkYiLz48L2c+PC9zdmc+">

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { 
            background-color: #020617; 
            color: white; 
            -webkit-tap-highlight-color: transparent; 
            user-select: none;
            font-family: system-ui, -apple-system, sans-serif;
            overflow: hidden; /* Evita rebote en iOS */
        }
        
        .tech-bg {
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(6, 182, 212, 0.05) 0%, transparent 50%),
                linear-gradient(0deg, rgba(15, 23, 42, 1) 0%, rgba(2, 6, 23, 1) 100%);
        }

        .btn-control {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            box-shadow: 5px 5px 10px #0b1120, -5px -5px 10px #2a3a52;
            transition: all 0.15s ease;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .btn-control:active {
            box-shadow: inset 5px 5px 10px #0b1120, inset -5px -5px 10px #2a3a52;
            transform: scale(0.98);
        }
        
        .btn-center {
            background: radial-gradient(circle, #1e293b 0%, #0f172a 100%);
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.1);
            border: 2px solid rgba(6, 182, 212, 0.2);
        }
        .btn-center:active {
            border-color: rgba(6, 182, 212, 0.8);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.4);
        }

        .hide-scroll::-webkit-scrollbar { display: none; }
        .glow-text { text-shadow: 0 0 10px rgba(6, 182, 212, 0.5); }
    </style>
</head>
<body>
    <div id="root" class="min-h-screen flex flex-col tech-bg"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInAnonymously } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, onSnapshot, updateDoc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const { useState, useEffect } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyBqHgV4vDat1-VmZfKbiPg7nuiX-ROcexw",
            authDomain: "cirineo-cec21.firebaseapp.com",
            projectId: "cirineo-cec21",
            storageBucket: "cirineo-cec21.firebasestorage.app",
            messagingSenderId: "620210618284",
            appId: "1:620210618284:web:482bab9bf74650fff18409"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        const MACHINES = [
            { id: 'm35', name: '35' }, { id: 'm39', name: '39' }, { id: 'm40', name: '40' },
            { id: 'm36', name: '36' }, { id: 'm38', name: '38' }, { id: 'm37', name: '37' },
            { id: 'm29', name: '29' }, { id: 'm28', name: '28' }, { id: 'm27', name: '27' },
            { id: 'm33', name: '33' }, { id: 'm1',  name: '01' }, { id: 'm30', name: '30' },
            { id: 'm31', name: '31' }, { id: 'm6',  name: '06' }, { id: 'm32', name: '32' },
            { id: 'm13', name: '13' }, { id: 'm12', name: '12' }, { id: 'm24', name: '24' },
            { id: 'm8',  name: '08' },
        ];

        const RemoteControl = () => {
            const [visibility, setVisibility] = useState({ machines: [] });
            const [navState, setNavState] = useState({ weekOffset: 0, scrollLevel: 0 });
            const [connected, setConnected] = useState(false);

            useEffect(() => {
                signInAnonymously(auth).then(() => setConnected(true));
                const unsubVis = onSnapshot(doc(db, 'settings', 'visibility'), (s) => {
                    if(s.exists()) setVisibility(s.data());
                });
                const unsubNav = onSnapshot(doc(db, 'settings', 'navigation'), (s) => {
                    if(s.exists()) setNavState(s.data());
                    else setDoc(doc(db, 'settings', 'navigation'), { weekOffset: 0, scrollLevel: 0 });
                });
                return () => { unsubVis(); unsubNav(); };
            }, []);

            const updateNav = (type, delta) => {
                const newState = { ...navState };
                if (type === 'week') {
                    newState.weekOffset = (newState.weekOffset || 0) + delta;
                    newState.scrollLevel = 0; 
                } else if (type === 'reset') {
                    newState.weekOffset = 0;
                    newState.scrollLevel = 0;
                }
                setDoc(doc(db, 'settings', 'navigation'), newState, { merge: true });
            };

            const toggleMachine = async (id) => {
                const isHidden = visibility.machines?.includes(id);
                let newMachines = [...(visibility.machines || [])];
                isHidden ? newMachines = newMachines.filter(m => m !== id) : newMachines.push(id);
                await updateDoc(doc(db, 'settings', 'visibility'), { machines: newMachines });
            };

            return (
                <div className="flex flex-col h-screen overflow-hidden relative">
                    
                    {/* --- HEADER CON TU ICONO --- */}
                    <div className="p-4 pt-8 flex justify-between items-center z-10 bg-slate-900/50 backdrop-blur-md border-b border-white/10">
                        <div className="flex items-center gap-3">
                            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIzcHgiIGhlaWdodD0iMjIzcHgiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbD0ibm9uZSI+PHJlY3Qgd2lkdGg9IjEwMjQiIGhlaWdodD0iMTAyNCIgZmlsbD0iI2ZmZmZmZiIvPjxnIHRyYW5zZm9ybT0icm90YXRlKDQ1IDUxMiA1MTIpIj48cGF0aCBkPSJNNjg3LjUgMTU0LjZjLTEwMi4yLTgyLjgtMjQ5LjEtODIuOC0zNTEuMiAwIDAgMC0xOS45IDIxLjctMzMuOSAyMS43cy03LjgtMjEuNy03LjgtMjEuN2MxMjAtMTIwIDMxNC42LTEyMCA0MzQuNiAwIDAgMCA2LjIgMjEuNy03LjggMjEuN3MtMzMuOS0yMS43LTMzLjktMjEuN3oiIGZpbGw9IiMwMDAwMDAiLz48cGF0aCBkPSJNMzU4LjIgMjMyLjJjLTE0IDAtNC40LTE4LjQtNC40LTE4LjQtemLjMtODcuMyAyMjguOC04Ny4zIDMxNi4xIDAgMCAwIDkuNiAxOC40LTQuNCAxOC40cy0zOC40LTE4LjQtMzguNC0xOC40Yy02OC40LTUwLTE2Mi01MC0yMzAuNSAwIDAgMC0yNC40IDE4LjQtMzguNCAxOC40eiIgZmlsbD0iIzAwMDAwMCIvPjxwYXRoIGQ9Ik00MTMuMSAyODguMWMtMTUgMCAwLTE1IDAtMTUgNTQuNi01NC42IDE0My01NC42IDE5Ny42IDAgMCAwIDE1IDE1IDAgMTVzLTQ2LjQtMTUtNDYuNC0xNWMtMzIuNi0xNy4zLTcyLTE3LjMtMTA0LjcgMCAwIDAtMzEuNSAxNS00Ni41IDE1ek0yNjAuNCA0ODMuNmMwLTMwLjkgMjMuNC02NC45IDUyLjQtNzQuOCAwIDAgODEtMzcgMjAyLjktMzdTNzExLjIgNDA4IDcxMS4yIDQwOGMyOC44IDEwLjkgNTIuMSA0NC42IDUyLjEgNzUuNnYzNjMuMmMwIDMwLjktMjMuMiA2NS4yLTUyLjEgNzUuNiAwIDAtNzMuNiAzNi4yLTE5NS41IDM2LjJzLTIwMi45LTM3LTIwMi45LTM3Yy0yOS0xMC40LTUyLjQtNDMuOC01Mi40LTc0LjhWNDgzLjZ6IiBmaWxsPSIjMDAwMDAwIi8+PHBhdGggZD0iTTMxNi4zIDQ4My42djM2My4yYzAgNy40IDguNyAxOS44IDE1LjUgMjIuMmw0LjIgMS43YzEuMiAwLjYgNC44IDIgMTAuNSA0LjEgMTAuMiAzLjcgMjIuMyA3LjUgMzYuMSAxMS4xIDM5LjkgMTAuNCA4NC43IDE2LjcgMTMzIDE2LjcgNDguMiAwIDkxLjUtNi4xIDEyOC45LTE2LjIgMjEuNi01LjggMzUuOC0xMS4zIDQxLjktMTQuM2wyLjktMS40IDMtMS4xYzYuMi0yLjIgMTUuMS0xNS4yIDE1LjEtMjN2LTM2M2MwLTcuNy04LjktMjAuNi0xNi0yMy4zbC00LjktMi4xYy02LjEtMy0yMC4zLTguNS00MS45LTE0LjMtMzcuNS0xMC4xLTgwLjctMTYuMi0xMjguOS0xNi4yLTQ4LjMgMC05My4xIDYuMy0xMzMgMTYuNy0xMy44IDMuNi0yNS45IDcuNC0zNi4xIDExLjEtNS43IDIuMS05LjMgMy42LTEwLjUgNC4xbC01LjEgMmMtNiAyLjItMTQuNyAxNC42LTE0LjcgMjJ6IiBmaWxsPSIjRkZGRkZGIi8+PHBhdGggZD0iTTU5NS43IDYyMy4zYy0zMC45IDAtNTUuOS0yNS01NS45LTU1LjlzMjUtNTUuOSA1NS45LTU1LjkgNTUuOSAyNSA1NS45IDU1LjktMjUgNTUuOS01NS45IDU1Ljl6TTQyOC4xIDYyMy4zYy0zMC45IDAtNTUuOS0yNS01NS45LTU1LjlzMjUtNTUuOSA1NS45LTU1LjkgNTUuOSAyNSA1NS45IDU1LjljLTAuMSAzMC45LTI1LjEgNTUuOS01NS45IDU1Ljl6TTUxMS45IDg0Ni44Yy00Ni4zIDAtODMuOC0zNy41LTgzLjgtODMuOHMzNy41LTgzLjggODMuOC04My44IDgzLjggMzcuNSA4My44IDgzLjggMzcuNSA4My44LTgzLjggODMuOHoiIGZpbGw9IiMwMDAwMDAiLz48cGF0aCBkPSJNNTk1LjcgNTk1LjRjMTUuNCAwIDI3LjktMTIuNSAyNy45LTI3LjlzLTEyLjUtMjcuOS0yNy45LTI3LjktMjcuOSAxMi41LTI3LjkgMjcuOSAxMi41IDI3LjkgMjcuOSAyNy45ek00MjguMSA1OTUuNGMxNS40IDAgMjcuOS0xMi41IDI3LjktMjcuOXMtMTIuNS0yNy45LTI3LjktMjcuOWMtMTUuNCAwLTI3LjkgMTIuNS0yNy45IDI3LjktMC4xIDE1LjQgMTIuNCAyNy45IDI3LjkgMjcuOXpNNTExLjkgODE4LjljMzAuOSAwIDU1LjktMjUgNTUuOS01NS45cy0yNS01NS45LTU1LjktNTUuOS01NS45IDI1LTU1LjkgNTUuOSAyNSA1NS45IDU1LjkgNTUuOXoiIGZpbGw9IiNGRkZGRkYiLz48L2c+PC9zdmc+" 
                                 className="w-10 h-10 rounded-lg shadow-[0_0_15px_rgba(6,182,212,0.3)] border border-cyan-500/30" />
                            <div>
                                <h1 className="text-lg font-black text-white tracking-widest leading-none">MAES26</h1>
                                <span className="text-[10px] text-cyan-400 font-bold uppercase tracking-[0.2em] glow-text">CONTROL REMOTO</span>
                            </div>
                        </div>
                        <div className="flex flex-col items-end">
                            <div className={`w-2 h-2 rounded-full mb-1 ${connected ? 'bg-green-400 shadow-[0_0_8px_#4ade80]' : 'bg-red-500 animate-pulse'}`}></div>
                            <span className="text-[8px] text-slate-500 uppercase font-bold">{connected ? 'ONLINE' : 'OFFLINE'}</span>
                        </div>
                    </div>

                    {/* --- CONTROLES DE NAVEGACIÓN --- */}
                    <div className="flex-1 flex flex-col justify-center items-center relative py-6">
                        
                        <div className="absolute inset-0 pointer-events-none flex justify-center items-center opacity-10">
                            <div className="w-64 h-64 border border-cyan-500 rounded-full border-dashed animate-[spin_10s_linear_infinite]"></div>
                            <div className="absolute w-48 h-48 border border-slate-500 rounded-full animate-[spin_15s_linear_infinite_reverse]"></div>
                        </div>

                        <div className="flex flex-col items-center gap-6 z-10 w-full max-w-[200px]">
                            
                            {/* SEMANA ANTERIOR */}
                            <button onClick={() => updateNav('week', -1)} 
                                className="btn-control w-24 h-20 rounded-2xl flex items-center justify-center text-cyan-400 active:text-white group">
                                <i data-lucide="chevron-up" className="w-12 h-12 transition-transform group-active:-translate-y-1"></i>
                            </button>

                            {/* DISPLAY CENTRAL */}
                            <button onClick={() => updateNav('reset', 0)} 
                                className="btn-center w-32 h-32 rounded-full flex flex-col items-center justify-center relative overflow-hidden group">
                                <div className="absolute inset-0 bg-cyan-500/10 opacity-0 group-active:opacity-100 transition-opacity"></div>
                                <span className="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Semana</span>
                                <span className="text-3xl font-black text-white glow-text">{navState.weekOffset > 0 ? `+${navState.weekOffset}` : navState.weekOffset}</span>
                                <div className="mt-2 px-2 py-0.5 bg-cyan-900/50 rounded text-[9px] text-cyan-300 font-bold border border-cyan-500/30">
                                    RESET HOY
                                </div>
                            </button>

                            {/* SEMANA SIGUIENTE */}
                            <button onClick={() => updateNav('week', 1)} 
                                className="btn-control w-24 h-20 rounded-2xl flex items-center justify-center text-cyan-400 active:text-white group">
                                <i data-lucide="chevron-down" className="w-12 h-12 transition-transform group-active:translate-y-1"></i>
                            </button>

                        </div>
                    </div>

                    {/* --- SELECTOR DE MÁQUINAS --- */}
                    <div className="bg-slate-900/80 backdrop-blur-xl rounded-t-[2.5rem] border-t border-white/5 shadow-[0_-10px_40px_rgba(0,0,0,0.5)] flex flex-col max-h-[45vh]">
                        
                        <div className="p-5 pb-2 flex justify-between items-end border-b border-white/5 mx-4">
                            <div>
                                <h2 className="text-sm font-bold text-slate-300 uppercase tracking-wider">Visibilidad</h2>
                                <p className="text-[10px] text-slate-500">Toca para ocultar/mostrar</p>
                            </div>
                            <div className="flex items-center gap-2">
                                <i data-lucide="monitor" className="w-4 h-4 text-cyan-500"></i>
                                <span className="font-mono font-bold text-cyan-400">
                                    {MACHINES.length - (visibility.machines?.length || 0)}<span className="text-slate-600">/{MACHINES.length}</span>
                                </span>
                            </div>
                        </div>

                        <div className="overflow-auto p-4 pb-8 hide-scroll grid grid-cols-4 gap-3">
                            {MACHINES.map(m => {
                                const isHidden = visibility.machines?.includes(m.id);
                                return (
                                    <button 
                                        key={m.id}
                                        onClick={() => toggleMachine(m.id)}
                                        className={`
                                            relative h-14 rounded-xl font-bold text-sm transition-all duration-200 flex flex-col items-center justify-center
                                            ${isHidden 
                                                ? 'bg-slate-800/50 text-slate-600 border border-slate-700/50 grayscale opacity-60' 
                                                : 'bg-gradient-to-br from-cyan-600 to-blue-700 text-white border border-cyan-400/50 shadow-[0_0_15px_rgba(6,182,212,0.3)]'
                                            }
                                        `}
                                    >
                                        <span className="text-[10px] opacity-70 uppercase tracking-wider">MAQ</span>
                                        <span className="text-lg leading-none">{m.name}</span>
                                        {!isHidden && <div className="absolute top-1 right-1 w-1.5 h-1.5 bg-white rounded-full shadow-[0_0_5px_white]"></div>}
                                    </button>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RemoteControl />);
        lucide.createIcons();
    </script>
</body>
</html>